New changes:
With tests:

commit 1